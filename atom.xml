<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[Dias de Dev]]></title>
    <link href="https://dias.dev/atom.xml" rel="self"/>
    <link href="https://dias.dev"/>
    <updated>2022-10-08T04:42:58+00:00</updated>
    <id>https://dias.dev</id>
        <generator uri="http://sculpin.io/">Sculpin</generator>
            <entry>
            <title type="html"><![CDATA[Cookies e seguran√ßa]]></title>
            <link href="https://dias.dev/2022-09-27-cookies-e-seguranca/"/>
            <updated>2022-09-27T00:00:00+00:00</updated>
            <id>https://dias.dev/2022-09-27-cookies-e-seguranca/</id>
            <content type="html"><![CDATA[<p><em>Cookies</em> s√£o amplamente utilizados para armazenar informa√ß√µes em nossos navegadores e muitas vezes n√≥s negligenciamos a seguran√ßa dessas informa√ß√µes. Cookies podem conter dados sens√≠veis como sua informa√ß√£o de sess√£o, por exemplo, por isso devemos nos preocupar com seu armazenamento.</p>

<h2 id="o-que-s%C3%A3o-_cookies_%3F">O que s√£o <em>cookies</em>?</h2>

<p>Um <em>cookie</em> √©, basicamente, uma informa√ß√£o de texto enviada pelo servidor de uma aplica√ß√£o web e salva no navegador. Ap√≥s salvar essa informa√ß√£o, o navegador reenvia os <em>cookies</em> em todas as requisi√ß√µes realizadas. <em>Cookies</em> s√£o enviados atrav√©s de cabe√ßalhos HTTP tanto do servidor para o cliente quanto do cliente para o servidor.</p>

<p>Se voc√™ n√£o est√° familiarizado com o protocolo HTTP, pode conferir este v√≠deo antes de continuar a leitura:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/B2IWlnJ_dt0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Dessa forma um servidor pode, por exemplo, ao receber as credenciais do usu√°rio, gerar um ID √∫nico e enviar atrav√©s de cookies. A partir disso, todas as requisi√ß√µes futuras que o navegador fizer conter√£o essa identifica√ß√£o do usu√°rio. Assim funciona o mecanismo de sess√µes que nos permite permanecer logados em sites.</p>

<h3 id="onde-ficam-os-_cookies_">Onde ficam os <em>cookies</em></h3>

<p>Cada navegador pode salvar seus <em>cookies</em> como preferir. Seja em um banco de dados embutido, em arquivos de texto encriptados no sistema operacional, etc. Mas para visualizar os cookies de uma aplica√ß√£o que estamos acessando, podemos utilizar as ferramentas de desenvolvedor.</p>

<p>Aperte F12, v√° at√© a aba "Aplicativo" (ou "Application") e l√° voc√™ ver√°, no menu lateral, a parte de <em>Cookies</em>. Repare que eles s√£o separados por dom√≠nio.</p>

<p>Para entender essa separa√ß√£o por dom√≠nio, vamos imaginar o seguinte cen√°rio: sua aplica√ß√£o, hospedada no dom√≠nio X, envia um <em>cookie</em> de identifica√ß√£o de sess√£o. No c√≥digo do seu app h√° chamadas para um servidor que configura relat√≥rios de acesso ao site. Esse servidor est√° em outro local, no dom√≠nio Y. Sendo assim, voc√™ ver√° <em>cookies</em> dos dom√≠nios X e Y ao acessar essa ferramenta de desenvolvedores.</p>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h3 id="o-que-_cookies_-armazenam">O que <em>Cookies</em> armazenam</h3>

<p>Entendido o funcionamento b√°sico e onde encontr√°-los, vamos analisar quais informa√ß√µes um <em>cookie</em> pode conter. Todo cookie possui, necessariamente, um nome e um valor. O nome √©, como voc√™ deve imaginar, a forma que usamos para identificar a informa√ß√£o que esse cookie carrega em seu valor. Um <em>cookie</em> de sess√£o, por exemplo, geralmente possui a palavra <em>session</em> em seu nome enquanto seu valor ser√° o ID da sess√£o.</p>

<p>Al√©m desses atributos "b√°sicos", cookies podem possuir par√¢metros extra. Alguns deles s√£o:</p>

<ul>
<li><code>Expires</code>: Define a data e hora de expira√ß√£o do cookie. Se esse par√¢metro n√£o for definido, o <em>cookie</em> ser√° considerado como "<em>cookie</em> de sess√£o" e ir√° expirar quando o navegador for fechado.</li>
<li><code>Max-Age</code>: Similar ao <code>Expires</code>, tamb√©m define quando um <em>cookie</em> vai expirar, mas em segundos. Se os 2 par√¢metros forem informados, <code>Max-Age</code> possui prioridade.</li>
<li><code>Domain</code>: Define para qual host o <em>cookie</em> ser√° enviado pelo navegador. Se esse par√¢metro n√£o for definido, o <em>cookie</em> ser√° enviado somente para o host da URL atual, n√£o incluindo sub-dom√≠nios. Se um valor como <code>example.com</code> for definido, o <em>cookie</em> ser√° enviado nas requisi√ß√µes para <code>example.com</code> e todos os seus sub-dom√≠nios.</li>
<li><code>Path</code>: Indica qual caminho deve existir na URL para que o <em>cookie</em> seja enviado pelo navegador. Se o valor for <code>/docs</code>, o <em>cookie</em> ser√° enviado para URLs como <code>/docs</code>, <code>/docs/</code>, <code>/docs/web</code>, etc, mas n√£o ser√° enviado para URLs como <code>/</code>, <code>/documentos</code>, <code>/pt-br/docs</code>, etc.</li>
<li><code>Secure</code>: Se esse par√¢metro for definido, o <em>cookie</em> s√≥ ser√° enviado em requisi√ß√µes HTTPS.</li>
<li><code>HttpOnly</code>: Proibe o acesso ao <em>cookie</em> em quest√£o atrav√©s de JavaScript com <code>document.cookie</code>.</li>
<li><code>SameSite</code>: Com os poss√≠veis valores sendo <code>Strict</code>, <code>Lax</code> e <code>None</code>, controla se o <em>cookie</em> pode ser enviado em requisi√ß√µes feitas a partir de outros sites para o do dom√≠nio do <em>cookie</em>.

<ul>
<li><code>Strict</code>: Apenas <em>cookies</em> para o endere√ßo da URL que est√° sendo acessada s√£o enviados. Isso faz com que a requisi√ß√£o inicial para um site n√£o contenha os <em>cookies</em> com esse par√¢metro, j√° que est√£o vindo de outro dom√≠nio.</li>
<li><code>Lax</code> (op√ß√£o padr√£o): Semelhante ao <code>Strict</code>, mas permite o envio dos <em>cookies</em> na requisi√ß√£o inicial. Isso permite, por exemplo, manter o usu√°rio logado ao chegar no sistema atrav√©s de um link externo.</li>
<li><code>None</code>: Quer dizer que os <em>cookies</em> ser√£o enviados mesmo se a requisi√ß√£o estiver vindo de outro endere√ßo. Para usar essa op√ß√£o, as vers√µes mais recentes dos navegadores exigem que o par√¢metro <code>Secure</code> seja definido.</li>
</ul></li>
</ul>

<h4 id="exemplos-de-defini%C3%A7%C3%B5es-de-_cookies_">Exemplos de defini√ß√µes de <em>cookies</em></h4>

<p>Para enviar um <em>cookie</em> de sess√£o, o seguinte cabe√ßalho pode ser enviado:</p>

<pre><code>Set-Cookie: sessionId=123456
</code></pre>

<p>J√° para um <em>cookie</em> permanente com dura√ß√£o de 1 semana:</p>

<pre><code>Set-Cookie: nome=valor; Max-Age=604800
</code></pre>

<h2 id="_cookies_-e-seguran%C3%A7a"><em>Cookies</em> e Seguran√ßa</h2>

<p>J√° entendemos o que s√£o, como funcionam e os par√¢metros de <em>cookies</em>. Agora vamos finalmente ao t√≥pico em quest√£o: <em>cookies</em> e seguran√ßa.</p>

<h3 id="_cookies_-e-xss"><em>Cookies</em> e XSS</h3>

<p>Como j√° foi citado, sess√µes s√£o um uso muito comum para <em>cookies</em>. As linguagens de back-end, inclusive, j√° lidam com esse detalhe de forma transparente na maioria das vezes. Agora imagine o seguinte cen√°rio: atrav√©s de um ataque de <a href="https://www.youtube.com/watch?v=lntsVxPZibw">XSS</a> um usu√°rio malicioso consegue acesso ao seu <em>cookie</em> de sess√£o. Com isso ele conseguir√° se passar por voc√™ e o estrago pode ser enorme.</p>

<p>Para prevenir que ataques XSS consigam acessar seus <em>cookies</em> sens√≠veis (como o de sess√£o), podemos marc√°-lo como <code>HttpOnly</code>. Dessa forma, c√≥digo JavaScript nenhum ter√° acesso ao mesmo.</p>

<p>Claro que um sistema com vulnerabilidade a <em>XSS</em> est√° em GRANDES riscos, mas para evitar <a href="https://owasp.org/www-community/attacks/Session_hijacking_attack"><em>session hijacking</em></a>, tornar o <em>cookie</em> <code>HttpOnly</code> j√° √© um grande passo.</p>

<p>Como j√° foi explicado anteriormente, o par√¢metro <code>HttpOnly</code> impede que o <em>cookie</em> em quest√£o seja acessado via <code>document.cookie</code>. Mas caso voc√™ precise realizar requisi√ß√µes via JavaScript, saiba que a fun√ß√£o <code>fetch</code> vai conseguir enviar os mesmos sem problema. :-D</p>

<p>Cada linguagem back-end pode fornecer suas facilidades para definir o <em>cookie</em> de sess√£o como <code>HttpOnly</code>. No PHP, por exemplo, al√©m da fun√ß√£o <code>session_set_cookie_params</code>, h√° configura√ß√µes como a <code>session.cookie_httponly</code>. O cabe√ßalho de um <em>cookie</em> <code>HttpOnly</code> seria parecido com:</p>

<pre><code>Set-Cookie: sessionId=123456; HttpOnly
</code></pre>

<h3 id="_cookies_-e-csrf"><em>Cookies</em> e CSRF</h3>

<p>Um ataque <em>CSRF</em> (<em>Cross-Site Request Forgery</em>) permite que um atacante se passe por outro usu√°rio tabm√©m, enviando requisi√ß√µes de um site para outro.</p>

<p>Para exemplificar: imagine que meu site dias.dev seja malicioso. Nele eu vou colocar a seguinte tag <code>img</code>:</p>

<pre><code class="html">&lt;img src="https://example.com/index.php?action=delete&amp;id=123" /&gt;
</code></pre>

<p>Se voc√™, acessando meu site, estiver logado em <code>example.com</code> (com o <em>cookie</em> armazenado e o par√¢metro <code>SameSite=None</code>), essa requisi√ß√£o vai ser feita com sucesso para uma a√ß√£o de remo√ß√£o de um dado e voc√™ nem vai perceber. S√≥ haver√° uma "imagem quebrada" no site.</p>

<p>Para impedir que a partir de um site, <em>cookies</em> sejam enviados para outro, podemos (dentre outras coisas), definir a pol√≠tica de <code>SameSite</code> como <code>Lax</code> (o que via de regra √© o padr√£o) ou <code>Strict</code>:</p>

<pre><code>Set-Cookie: sessionId=123456; HttpOnly; SameSite=Lax
</code></pre>

<p>Agora nosso <em>cookie</em> al√©m de n√£o ser mais acess√≠vel via JavaScript, s√≥ √© enviado em requisi√ß√µes realizadas a partir do nosso pr√≥prio site. Talvez voc√™ esteja se perguntando: se <code>Lax</code> j√° √© o padr√£o, por que me preocupar? Acontece que algumas linguagens ou frameworks back-end podem alterar esse padr√£o por diversos motivos. Por isso √© importante saber como usar esse par√¢metro.</p>

<h3 id="_cookies_-e-ataques-_man-in-the-middle_"><em>Cookies</em> e ataques <em>Man in the middle</em></h3>

<p>Outra forma de realizar <a href="https://owasp.org/www-community/attacks/Session_hijacking_attack"><em>session hijacking</em></a> seria um ataque do tipo <em>Man in the middle</em>, onde um atacante observa as requisi√ß√µes realizadas a partir do seu computador para o servidor. Se a requisi√ß√£o n√£o for criptografada, ou seja, n√£o usar HTTPS, o atacante ter√° acesso a todos os <em>cookies</em>.</p>

<p>Para impedir que um <em>cookie</em> seja enviado em requisi√ß√µes n√£o criptografadas, basta definir o par√¢metro <code>Secure</code>. Quando uma requisi√ß√£o sem HTTPS acontecer, esse <em>cookie</em> n√£o ser√° enviado. Com isso, nosso <code>header</code> ficaria:</p>

<pre><code>Set-Cookie: sessionId=123456; HttpOnly; SameSite=Lax; Secure
</code></pre>

<h2 id="conclus%C3%A3o">Conclus√£o</h2>

<p>Repare que o uso correto dos par√¢metros dos <em>cookies</em> j√° nos protege de diversos ataques. Obviamente apenas cuidar dos nossos <em>cookies</em> n√£o √© o suficiente para ter um sistema verdadeiramente seguro. Precisamos nos atentar a diversos outros fatores e poss√≠veis vulnerabilidades. Al√©m disso, <em>cookies</em> de sess√£o n√£o s√£o os √∫nicos a serem cuidados. <em>Tokens</em> geralmente s√£o armazenados como <em>cookies</em> tamb√©m e todos esses cuidados devem ser tomados.</p>

<p>Se seguran√ßa √© um assunto que te interessa, recomendo essa <em>playlist</em> com alguns v√≠deos b√°sicos sobre o assunto: <a href="https://www.youtube.com/playlist?list=PL3j2sfzg3FPuOOt13tOcNTx6hCFYcQls9">https://www.youtube.com/playlist?list=PL3j2sfzg3FPuOOt13tOcNTx6hCFYcQls9</a></p>

<p>Se quiser se aprofundar, na Alura h√° diversos cursos e forma√ß√µes sobre o tema de seguran√ßa. Aqui est√° um cupom de desconto para assinar a plataforma:
<a href="https://www.alura.com.br/promocao/diasdedev">https://www.alura.com.br/promocao/diasdedev</a></p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Paralelizar testes automatizados]]></title>
            <link href="https://dias.dev/2022-09-16-paralelizar-testes-automatizados/"/>
            <updated>2022-09-16T00:00:00+00:00</updated>
            <id>https://dias.dev/2022-09-16-paralelizar-testes-automatizados/</id>
            <content type="html"><![CDATA[<p>Testes automatizados podem levar um certo tempo para serem executados, principalmente se forem rodados um a um. Executar mais de um teste por vez pode ser uma boa alternativa para agilizar sua <em>pipeline</em>.</p>

<h2 id="testes-automatizados">Testes automatizados</h2>

<p>A cria√ß√£o e execu√ß√£o de testes automatizados traz in√∫meras vantagens e isso por si s√≥ poderia ser assunto para outro post completo. Mas um ponto que muitas vezes negligenciamos √© o tempo que a execu√ß√£o dos testes pode tomar em nossa <em>pipeline</em> de <em>build</em>.</p>

<p>Uma das etapas mais importantes em um ambiente de CI/CD, por exemplo, √© a execu√ß√£o dos testes. E sabemos que ter um processo demorado aqui pode at√© inviabilizar a ado√ß√£o de pr√°ticas de integra√ß√£o cont√≠nua.</p>

<p>√â muito comum que ao executar a nossa su√≠te de testes, cada cen√°rio seja executado de forma isolada, um por vez. Por√©m, atualmente √© praticamente regra que os nossos computadores possuam CPUs com capacidade de executar mais de um processo por vez, sendo assim, por que n√£o executar mais de um teste por vez?</p>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="paraleliza%C3%A7%C3%A3o-de-testes">Paraleliza√ß√£o de testes</h2>

<p>Paralelismo √© um assunto bastante complexo, mas a ideia de paralelizar uma su√≠te de testes √©, na verdade, bem simples: executar mais de um caso de teste por vez, em processos separados.</p>

<p>Um ponto que deve ser considerado √© a independ√™ncia dos testes. Cada teste deve ser completamente independente e n√£o pode usar o resultado ou a√ß√µes de testes anteriores. Uma forma aumentar a seguran√ßa de que os seus testes atualmente s√£o independentes √© rod√°-los fora de ordem. Dessa forma, se algum teste dependia do anterior, por exemplo, ao execut√°-los em uma ordem aleat√≥ria ele passar√° a falhar.</p>

<h2 id="ferramentas">Ferramentas</h2>

<p>Tendo entendido a ideia de rodar mais de um teste por vez e que para isso os testes precisam ser independentes, como podemos efetivamente atingir o paralelismo nos nossos testes?</p>

<p>Cada ecossistema ter√° a sua solu√ß√£o. Em PHP, por exemplo, podemos usar o <a href="https://github.com/paratestphp/paratest">Paratest</a>. N√£o √© necess√°ria nenhuma configura√ß√£o. Se voc√™ tem os seus testes rodando com PHPUnit, basta executar o comando <code>paratest</code> ao inv√©s de <code>phpunit</code>, mais nada. J√° em JS, cada framework de testes possui uma abordagem diferente. O Jest j√° executa os testes de arquivos diferentes de forma paralela por padr√£o. Em Java, a sua su√≠te JUnit pode usar uma ferramenta chamada Surefire. MSTest (para C#) na sua vers√£o 2 permite paralelizar testes tamb√©m. ExUnit (para Elixir) j√° executa os testes de cada m√≥dulo de forma paralela. Testes em Rust tamb√©m s√£o executados em paralelo por padr√£o.</p>

<h2 id="conclus%C3%A3o">Conclus√£o</h2>

<p>A vantagem de paralelizar testes √© bastante clara e a desvantagem √© somente a necessidade dos testes serem isolados, o que j√° deveria ser um padr√£o independente da forma de execu√ß√£o.</p>

<p>Cada ecossistema e ferramenta resolve esse problema de uma maneira diferente, mas todos eles possuem alguma solu√ß√£o. Vale a pesquisa para saber mais sobre a linguagem com a qual voc√™ trabalha.</p>

<p>Se n√£o estiver familiarizado com conceitos de testes, sugiro assistir <a href="https://www.youtube.com/playlist?list=PL3j2sfzg3FPsPiaDUmDDKNvco49YMdj8f">esta playlist</a> de testes automatizados. E se quiser se aprofundar em testes e programa√ß√£o em geral, aqui tem um cupom de desconto para voc√™ assinar Alura: <a href="https://www.alura.com.br/promocao/diasdedev">https://www.alura.com.br/promocao/diasdedev</a></p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Extens√µes PHP]]></title>
            <link href="https://dias.dev/2022-02-13-extensoes-php/"/>
            <updated>2022-02-13T00:00:00+00:00</updated>
            <id>https://dias.dev/2022-02-13-extensoes-php/</id>
            <content type="html"><![CDATA[<p>PHP √© uma linguagem de programa√ß√£o que roda em uma m√°quina virtual chamada <em>Zend Engine</em>. Essa m√°quina
virtual √© escrita em C e permite que n√≥s escrevamos c√≥digo em C para embutir funcionalidades no PHP. Assim funcionam as
extens√µes do PHP.</p>

<h2 id="o-que-s%C3%A3o-extens%C3%B5es-do-php%3F">O que s√£o extens√µes do PHP?</h2>

<p>As extens√µes no PHP s√£o c√≥digos escritos em C que s√£o, de certa forma, embutidos na linguagem, logo, se parecem com c√≥digo
nativo. √â poss√≠vel criarmos novas fun√ß√µes, classes e at√© criar sintaxe nova na linguagem a partir de extens√µes.</p>

<p>Quem usa PHP no dia-a-dia com certeza usa alguma extens√£o. Alguns exemplos de extens√µes PHP bem comuns:</p>

<ul>
<li>PDO</li>
<li>Sessions</li>
<li>JSON</li>
<li>cURL</li>
</ul>

<h2 id="tipos-de-extens%C3%B5es">Tipos de extens√µes</h2>

<p>Al√©m de existir um n√∫mero enorme de extens√µes do PHP, existem tamb√©m alguns tipos onde elas podem ser categorizadas.
Estes tipos s√£o: <em>Core Extensions</em>, <em>Bundled Extensions</em>, <em>External Extensions</em> e <em>PECL Extensions</em>.</p>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h3 id="core-extensions">Core Extensions</h3>

<p>As extens√µes <em>Core</em>, como o nome j√° diz, fazem parte do <em>core</em> (n√∫cleo) do PHP. O PHP n√£o existe sem elas e √© imposs√≠vel
ter uma instala√ß√£o do PHP sem estas. Alguns exemplos deste tipo de extens√µes s√£o: Arrays, Classes/Objects, Date/Time,
JSON, OPCache etc.</p>

<p>Estas extens√µes s√£o mantidas pela pr√≥pria equipe do PHP j√° que fazem parte da linguagem em si.</p>

<h3 id="bundled-extensions">Bundled Extensions</h3>

<p>As extens√µes empacotadas com o PHP, chamadas de <em>bundled extensions</em>, s√£o extens√µes que j√° v√™m junto com o PHP, mas √©
poss√≠vel escolher habilit√°-las ou n√£o em sua instala√ß√£o. Estas extens√µes tamb√©m s√£o mantidas pela equipe do PHP j√° que
s√£o empacotadas junto com o restante do c√≥digo da linguagem.</p>

<p>Alguns exemplos de extens√µes deste tipo: PDO, GD, FFI, intl, Sessions etc.</p>

<h3 id="external-extensions">External Extensions</h3>

<p>As extens√µes externas s√£o id√™nticas √†s <em>bundled</em> em quase todos os aspectos. Elas v√™m com o PHP, podem ser habilitadas
ou n√£o e s√£o mantidas pela equipe do <em>core</em>, por√©m possuem uma diferen√ßa: elas possuem depend√™ncias externas.</p>

<p>Para ter este tipo de extens√£o em sua instala√ß√£o do PHP voc√™ vai precisar ter alguma outra biblioteca ou programa em seu
sistema operacional. A extens√£o <em>cURL</em>, por exemplo, entra nessa categoria. Para ter essa extens√£o no PHP voc√™ precisa
do software <em>cURL</em> instalado no sistema, j√° que a extens√£o faz uso do c√≥digo disponibilizado por este software.</p>

<p>Alguns exemplos de extens√µes externas s√£o: cURL, DOM, OpenSSL, Sodium, Zip etc.</p>

<h3 id="pecl-extensions">PECL Extensions</h3>

<p>Por √∫ltimo n√≥s temos as extens√µes disponibilizadas por terceiros usando <em>PECL</em>, que √© basicamente um reposit√≥rio para
extens√µes PHP, como se fosse o <em>Packagist</em> de extens√µes. Se voc√™ pretende criar uma extens√£o para o PHP, vai utilizar
este reposit√≥rio.</p>

<p>As extens√µes desta categoria s√£o mantidas por terceiros e podem ou n√£o possuir depend√™ncias externas. Nem todas as
extens√µes desta categoria est√£o no manual da linguagem, afinal de contas √© poss√≠vel que qualquer pessoa crie uma
extens√£o.</p>

<p>Alguns exemplos interessantes de extens√µes disponibilizadas atrav√©s do <em>PECL</em>: DS (Data Structures), EV, Memcached,
Parallel, Swoole etc.</p>

<h2 id="refer%C3%AAncias">Refer√™ncias</h2>

<p>Conhecer todas extens√µes do PHP √© simplesmente imposs√≠vel, mas conhecer bem algumas extens√µes mais importantes para seu
dia-a-dia √© de extrema import√¢ncia.</p>

<p><a href="https://www.php.net/manual/en/extensions.membership.php">Aqui</a> voc√™ pode conferir a lista completa de extens√µes do
manual do PHP, todas classificadas por categoria.</p>

<p>Se voc√™ tiver interesse em criar suas pr√≥prias extens√µes, existem alguns materiais interessantes dispon√≠veis (embora
n√£o seja uma tarefa t√£o trivial). No tutorial <em><a href="https://flavioheleno.github.io/how-do-i/">How do I</a></em> do Flavio Heleno
voc√™ pode conferir o in√≠cio dessa jornada de cria√ß√£o de extens√µes al√©m de conferir outras refer√™ncias.</p>

<h2 id="conclus%C3%A3o">Conclus√£o</h2>

<p>A linguagem de programa√ß√£o PHP √© escrita em C e possui diversas extens√µes que fazem parte ou n√£o da linguagem. N√≥s
fazemos uso de v√°rias extens√µes no dia-a-dia e entender este funcionamento √© bastante importante para devs PHP.</p>

<p>Se al√©m de entender sobre algumas extens√µes voc√™ quiser aprender mais sobre PHP em si, voc√™ pode usar esse
<a href="https://www.alura.com.br/promocao/diasdedev">cupom</a> que fornece 10% de desconto na assinatura da Alura, plataforma onde
eu mesmo gravei diversos cursos sobre o assunto.</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[O que s√£o PWAs?]]></title>
            <link href="https://dias.dev/2021-09-14-o-que-sao-pwas/"/>
            <updated>2021-09-14T00:00:00+00:00</updated>
            <id>https://dias.dev/2021-09-14-o-que-sao-pwas/</id>
            <content type="html"><![CDATA[<p><em>Progressive Web Apps</em>, como o nome mesmo j√° diz, s√£o aplicativos <em>web</em> progressivos. Vamos falar um pouco mais sobre a parte de "progressivos", mas o b√°sico √© isso: Um aplicativo que roda no "mundo <em>web</em>"</p>

<h2 id="aplicativo-na-web%3F">Aplicativo na Web?</h2>

<p>Quando falamos de aplicativos, principalmente m√≥veis, pensamos logo em acessar uma loja de aplicativos, escolher um dispon√≠vel e instalar. Pensamos em todo o poder que estes aplicativos t√™m de controlar o <em>hardware</em> de nossos dispositivos. Mas ser√° que precisa ser assim?</p>

<p>Primeiro, precisamos mesmo de uma loja? Por que n√£o pesquisar diretamente no Google um servi√ßo ao inv√©s de pesquisar em uma loja de aplicativos? Segundo, ser√° que s√≥ aplicativos m√≥veis "nativos" s√£o capazes de controlar o <em>hardware</em> dos dispositivos onde eles rodam?</p>

<p><img src="https://web-dev.imgix.net/image/tcFciHGuF3MxnTr1y5ue01OGLBn2/1DKtUFjXLJbiiruKA9P1.svg" alt="Gr√°fico mostrando a rela√ß√£o entre capacidade e alcance de PWAs e aplica√ß√µes nativas e servi√ßos web, onde PWAs possuem tanta capacidade quanto um aplicativo nativo e tanto alcance quanto um servi√ßo Web" class="big-image" /></p>

<h2 id="o-poder-da-web">O poder da Web</h2>

<p>A <em>Web</em> evoluiu absurdamente nas √∫ltimas d√©cadas e trouxe muito poder para n√≥s <em>devs</em>. Coisas que antigamente seriam impens√°veis sem instalar de forma "nativa" uma aplica√ß√£o, hoje √© trivial de ser feito diretamente no navegador. Alguns exemplos:</p>

<ul>
<li>Acessar √† c√¢mera;</li>
<li>Disponibilidade offline;</li>
<li>Acesso ao GPS;</li>
<li>Execu√ß√£o de tarefas no plano de fundo;</li>
<li>etc.</li>
</ul>

<p>Hoje em dia √© perfeitamente poss√≠vel que ap√≥s acessar um aplicativo <em>web</em>, os pr√≥ximos acessos possam ser feitos sem uma conex√£o ativa com a <em>internet</em>. Al√©m disso √© muito comum aplicativos <em>web</em> acessarem recursos nativos como localiza√ß√£o, sistema de sons, baterias, etc.</p>

<p>Aqui voc√™ pode conferir algumas <em>APIs Web</em> para ter acesso a recursos que antigamente s√≥ eram poss√≠veis atrav√©s de aplica√ß√µes nativas: https://developer.mozilla.org/en-US/docs/Web/API</p>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="aplica%C3%A7%C3%B5es-progressivas">Aplica√ß√µes progressivas</h2>

<p>J√° vimos que atrav√©s da <em>Web</em> podemos ter acesso a recursos muito poderosos, mas o que significa o <strong>P</strong> de PWA?</p>

<p>PWAs s√£o aplica√ß√µes progressivas, ou seja, se adaptam a diferentes cen√°rios e dispositivos.</p>

<p>Um exemplo j√° citado de cen√°rio adverso: dispositivo sem conex√£o com a <em>internet</em>. Quando voc√™ acessa o aplicativo m√≥vel do Twitter sem estar conectado a <em>internet</em>, ele te mostra os <em>tweets</em> que j√° foram carregados anteriormente. Ou seja, a sua experi√™ncia √© degradada, mas o aplicativo continua funcionando. A ideia de PWAs √© exatamente essa.</p>

<p>Se voc√™ tentar acessar uma PWA que precisa da localiza√ß√£o do usu√°rio a partir de um dispositivo sem GPS, a aplica√ß√£o deve estar preparada para buscar a localiza√ß√£o menos precisa (atrav√©s da rede) ou solicitar o endere√ßo ao usu√°rio. Com isso, quanto mais recursos o dispositivo tiver, melhor ser√° a experi√™ncia. Em outras palavras, teremos uma experi√™ncia <strong>progressiva</strong>.</p>

<h2 id="posso-instalar-%22sites%22%3F">Posso instalar "sites"?</h2>

<p>Uma d√∫vida comum ao aprender sobre PWAs √© sobre a instala√ß√£o da aplica√ß√£o. N√£o seria pr√°tico que um usu√°rio precisasse abrir o navegador e digitar a URL da nossa aplica√ß√£o sempre que quisesse acess√°-la. Com aplicativos nativos n√≥s temos os √≠cones na tela inicial do dispositivo.</p>

<p>Outro ponto √© que um aplicativo possui uma experi√™ncia mais imersiva, sem interfer√™ncias de outras abas do navegador, al√©m de barras de ferramentas, etc.</p>

<p><img src="/build/pwa/pwa-ifood.jpg" alt="Tela da PWA do ifood, que √© exatamente igual ao aplicativo nativo" class="big-image" /></p>

<p>Como podemos ver, uma PWA pode se comportar visualmente exatamente como uma aplica√ß√£o nativa. As barras do navegador podem sumir, a cor da barra de notifica√ß√£o pode ser personalizada, etc.</p>

<p>Al√©m do mais, podemos optar por criar um atalho para essa aplica√ß√£o web direto em nossa tela inicial:</p>

<p><img src="/build/pwa/menu-instalar-ifood.jpg" alt='Tela do navegador com o menu aberto, mostrando a op√ß√£o de "Adicionar √† tela inicial"' class="big-image" /></p>

<p>Mas claro, nem todo usu√°rio vai abrir o menu do navegador para adicionar um atalho √† tela inicial. O ideal seria poder ter um bot√£o de instalar essa aplica√ß√£o para que o usu√°rio n√£o tenha esse "esfor√ßo".</p>

<p><img src="/build/pwa/tela-instalacao-uber.jpg" alt="Mensagem sugerindo a instala√ß√£o da PWA do uber sem precisar abrir o menu do navegador" class="big-image" /></p>

<p>Conforme podemos ver na imagem anterior, isso tamb√©m √© perfeitamente poss√≠vel. Al√©m de termos um bot√£o na aplica√ß√£o para instal√°-la, o pr√≥prio navegador ao identificar uma PWA pode sugerir sua instala√ß√£o. A ideia √© que isso fiquei cada vez mais natural, inclusive, com os navegadores tomando decis√µes mais assertivas ao fazer tais sugest√µes.</p>

<h2 id="como-desenvolver-pwas%3F">Como desenvolver PWAs?</h2>

<p>Como sou um desenvolvedor Web, o assunto de PWAs me anima bastante. A ideia deste post n√£o √© te ensinar a desenvolver PWAs, mas sim te apresentar ao conceito. Caso voc√™ tenha interesse na parte pr√°tica, vou deixar aqui algumas refer√™ncias.</p>

<p>Se voc√™ aprende melhor lendo, esse livro √© um √≥timo in√≠cio:</p>

<div class="iframe">
    <iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="//ws-na.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&OneJS=1&Operation=GetAdHtml&MarketPlace=BR&source=ss&ref=as_ss_li_til&ad_type=product_link&tracking_id=cviniciussd06-20&language=pt_BR&marketplace=amazon&region=BR&placement=B07BZK71NV&asins=B07BZK71NV&linkId=39b9fcf31f08c2d76b0d6f4284cb6a60&show_border=true&link_opens_in_new_window=true"></iframe>
</div>

<p>Por√©m uma desvantagem (na minha opini√£o) deste livro √© o uso de React para a cria√ß√£o da aplica√ß√£o. Eu gosto mais de conte√∫dos conceituais, que explicam a base sem o uso de muitas ferramentas.</p>

<p>Se voc√™ tamb√©m prefere esse tipo de conte√∫do, pode dar uma olhada nesse livro (um pouco mais caro):</p>

<div class="iframe" style="margin-bottom: 1rem;">
    <iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="//ws-na.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&OneJS=1&Operation=GetAdHtml&MarketPlace=BR&source=ss&ref=as_ss_li_til&ad_type=product_link&tracking_id=cviniciussd06-20&language=pt_BR&marketplace=amazon&region=BR&placement=B075HP52WY&asins=B075HP52WY&linkId=955ce63a435057d47ccd0bd81620193c&show_border=true&link_opens_in_new_window=true"></iframe>
</div>

<p>Agora se voc√™ prefere estudar atrav√©s de cursos e v√≠deos, super recomendo os treinamentos de front-end e de PWA da Alura. L√° voc√™ consegue toda a base para desenvolver uma PWA de forma profissional, aprendendo desde a base, passando por <em>JavaScript</em> avan√ßado e <em>APIs Web</em>, at√© <em>PWAs</em> de fato. Se for o seu caso, aqui tenho um cupom de 10% de desconto para estudar na Alura:
<a href="https://www.alura.com.br/promocao/diasdedev">https://www.alura.com.br/promocao/diasdedev</a></p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Charsets e Encodings: Como strings funcionam]]></title>
            <link href="https://dias.dev/2021-08-24-charsets-e-encodings-como-strings-funcionam/"/>
            <updated>2021-08-24T00:00:00+00:00</updated>
            <id>https://dias.dev/2021-08-24-charsets-e-encodings-como-strings-funcionam/</id>
            <content type="html"><![CDATA[<p>√â de conhecimento geral que computadores trabalham com n√∫meros, especificamente n√∫meros na base bin√°ria. Sabendo disso, como podemos representar o texto que eu estou escrevendo apenas com conjuntos de 0s e 1s? Como o computador, trabalhando apenas com n√∫meros, consegue lidar com textos?</p>

<h2 id="tabelas-de-caracteres-charsets">Tabelas de caracteres (Charsets)</h2>

<p>Para realizar essa tarefa, tabelas de caracteres (<em>charsets</em>) s√£o utilizadas. Com essas tabelas, algum caractere pode ser mapeado para algum n√∫mero. Esse n√∫mero que ser√° armazenado e manipulado pelos programas que lidam com textos. Mas como esse mapeamento √© feito?</p>

<h2 id="ascii">ASCII</h2>

<p>Uma das tabelas de caracteres mais antigas que se tem conhecimento √© a ASCII (<em>American Standard Code for Information Interchange</em>). Esta tabela cont√©m todos os n√∫meros e os caracteres usados pelo idioma ingl√™s, onde cada um desses caracteres √© mapeado para um n√∫mero e esse n√∫mero √© convertido diretamente para a base bin√°ria, sendo uma representa√ß√£o bastante simples. Os n√∫meros v√£o de 0 a 127, ou seja, qualquer caractere da tabela ASCII pode ser representado em at√© 7 <em>bits</em>, o que √© menos que 1 <em>byte</em> (1 <em>byte</em> = 8 <em>bits</em>).</p>

<p><img src="https://raw.githubusercontent.com/wiki/tomgibara/ascii-table/tables/ascii-table-1.1.png" alt="Tabela ASCII" /></p>

<p>Isso funcionava muito bem para textos que usavam ingl√™s como idioma (ou algum idioma com o mesmo conjunto de caracteres). Por√©m, diversos outros idiomas possuem caracteres que n√£o est√£o representados nesta tabela. Caracteres acentuados, por exemplo, n√£o est√£o na tabela ASCII. Como representar textos em portugu√™s, por exemplo?</p>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="extended-ascii">Extended ASCII</h2>

<p>Como pudemos ver na imagem da tabela ASCII, os valores v√£o de 0 a 127. Isso pode ser representado com 7 <em>bits</em>.</p>

<p>Como foi citado no cap√≠tulo anterior, todos os caracteres da tabela ASCII podem ser representados com at√© 7 <em>bits</em>. Sendo assim, temos 1 bit "sobrando" para cada caractere completar 1 <em>byte</em>.</p>

<p>Pensando nisso, surgiram diversas outras tabelas de caracteres fazendo uso deste bit adicional para representar outros caracteres. Desta forma √© criada a tabela ASCII estendida: <em>Extended ASCII</em> ou <em>EASCII</em></p>

<p><img src="https://files.passeidireto.com/0b57a2e8-7fae-4e06-ac73-a7004f09a741/0b57a2e8-7fae-4e06-ac73-a7004f09a741.gif" alt="Tabela ASCII Estendida" /></p>

<p>Ao mesmo tempo, outros idiomas que possuem seu alfabeto sem nenhuma semelhan√ßa com o ingl√™s (como japon√™s ou russo) utilizavam tabelas completamente diferentes para representar seus caracteres.</p>

<h2 id="ascens%C3%A3o-da-web">Ascens√£o da Web</h2>

<p>O uso de tabelas diferentes funcionou muito bem enquanto os arquivos ficavam apenas em um computador ou eram compartilhados em redes locais (como de universidades). Por√©m, conforme a Web nasceu e cresceu, o compartilhamento de arquivos se tornou uma tarefa trivial. Como eu, no Brasil, poderia enviar um documento para o Egito, usando o alfabeto grego? Essa tarefa era simplesmente imposs√≠vel.</p>

<h2 id="unicode">Unicode</h2>

<p>Pensando em ter uma forma unificada de representar todos os caracteres conhecidos no mundo, em 1991 foi criada o <em>Unicode Consortium</em>. Essa iniciativa trabalha e tem encontros frequentes para garantir que h√° suporte a todos os idiomas e caracteres conhecidos pela humanidade, incluindo <em>emojis</em>. Parece um trabalho enorme e realmente √©.</p>

<p><em>Emojis</em>, por exemplo, foram sugeridos √† iniciativa em meados de 2000, por√©m apenas ap√≥s 2007 eles foram incorporados ao <em>Unicode</em>.</p>

<p>Ent√£o, se formos supersimplificar (muito), podemos dizer que o <em>Unicode Consortium</em> criou um grande <em>charset</em>, ou seja, uma grande tabela de caracteres. Por√©m, essa "tabela" √© gigante! Como representar estes n√∫meros enormes de forma eficiente?</p>

<h2 id="encodings">Encodings</h2>

<p>Aqui entram os encodings. O n√∫mero <strong>128 512</strong> (em hexadecimal, 1F600) representa o emoji de sorriso (üòÄ). Esse n√∫mero <strong>128 512</strong> pode ser representado de v√°rias formas dependendo do encoding selecionado para tal arquivo. Alguns encodings compat√≠veis com <em>Unicode</em> s√£o:
- UTF-8
- UTF-16
- UTF-32</p>

<p>Inicialmente eu acreditava que a diferen√ßa entre eles era apenas o n√∫mero de <em>bits</em> utilizado, sendo assim UTF-8 poderia representar menos caracteres j√° que usa menos bits. N√£o √© o caso. Todos eles podem consumir um n√∫mero vari√°vel de <em>bits</em> os organizando de forma diferente. Cada encoding pode ser mais vantajoso dependendo do cen√°rio. Para representar textos (como esse que escrevo) e mensagens transferidas pela rede, UTF-8 √© o mais recomendado e utilizado, visto que sua organiza√ß√£o permite que os caracteres mais comuns ocupem o menor espa√ßo poss√≠vel. J√° UTF-16 ocupa menos espa√ßo representando caracteres com n√∫meros maiores na "tabela" unicode.</p>

<h2 id="conclus%C3%A3o">Conclus√£o</h2>

<p>√â comum utilizarmos fun√ß√µes de convers√£o de encoding sem entender bem o que estamos fazendo e muito provavelmente todo mundo que desenvolve <em>software</em> para a <em>web</em> j√° se deparou com o seguinte problema:</p>

<p><img src="https://i.stack.imgur.com/590Tg.png" alt="Texto com caracteres mal codificados" /></p>

<p>Entender como funcionam charsets e encodings de texto al√©m de ser interessante e divertido, pode nos ajudar a compreender melhor problemas deste tipo e principalmente encontrar a solu√ß√£o de forma mais simples.</p>

<p>Creio que seja seguro afirmar que a grande maioria dos textos que tratamos como desenvolvedores utiliza UTF-8 como encoding e neste artigo n√≥s entendemos o motivo disso e como o tratamento de textos evoluiu at√© chegar a esse ponto.</p>

<p>Se voc√™ quiser aprender mais sobre esse assunto, pode considerar assinar a Alura. L√° existem treinamentos que tratam sobre charsets, encoding, manipula√ß√£o de <em>strings</em>    e muito mais. Caso pretenda estudar na Alura, <a href="https://www.alura.com.br/promocao/diasdedev">neste link</a> voc√™ tem um desconto de 10%.</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Como o PHP funciona na Web?]]></title>
            <link href="https://dias.dev/2021-06-15-como-o-php-funciona-na-web/"/>
            <updated>2021-06-15T00:00:00+00:00</updated>
            <id>https://dias.dev/2021-06-15-como-o-php-funciona-na-web/</id>
            <content type="html"><![CDATA[<p>O PHP √© o que conhecemos como linguagem <em>server-side</em>, ou seja, ele roda nos servidores web, e n√£o nos navegadores.</p>

<p>Isso j√° √© de conhecimento geral, mas nem todos entendem como uma requisi√ß√£o sai do navegador e chega em seu c√≥digo PHP. √â exatamente sobre isso que vamos tratar neste artigo.</p>

<h2 id="como-funciona-a-web%3F">Como funciona a Web?</h2>

<p>Antes de falarmos sobre o papel do PHP na Web, √© muito importante entendermos como a Web funciona. O protocolo HTTP √© o que torna toda a comunica√ß√£o entre nosso navegador e servidores, poss√≠vel, ent√£o √© de suma import√¢ncia que a gente estude ele.</p>

<p>Neste v√≠deo eu expliquei um pouco de como funciona o processo desde quando damos <em>Enter</em> em nosso navegador at√© termos uma resposta em nossa tela. Vale a pena conferir antes de continuar lendo este artigo:</p>

<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/B2IWlnJ_dt0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>Existem v√°rias outras refer√™ncias (inclusive mais completas) para voc√™ conhecer as tecnologias por tr√°s da Web. Vou deixar aqui algumas refer√™ncias:
- <a href="https://amzn.to/3lzFVkD">Desconstruindo a Web: As tecnologias por tr√°s de uma requisi√ß√£o</a>
- <a href="https://amzn.to/35k9rT1">HTTP: The Definitive Guide</a>
- <a href="https://amzn.to/3gEgz22">Learning Http/2: A Practical Guide for Beginners</a>
- <a href="https://www.alura.com.br/promocao/diasdedev">Cursos de HTTP na Alura</a></p>

<p>Com esse conhecimento, j√° podemos partir para o foco deste artigo: como o <strong>PHP</strong> funciona na Web?</p>

<h2 id="cgi-_common-gateway-interface_">CGI (<em>Common Gateway Interface</em>)</h2>

<p>A primeira forma de se executar c√≥digo em servidores ao receber uma requisi√ß√£o HTTP foi atrav√©s de uma t√©cnica chamada CGI (<em>Common Gateway Interface</em>).</p>

<p>Esta t√©cnica consistia em basicamente um servidor Web (como Apache, por exemplo) receber uma requisi√ß√£o HTTP e executar um processo enviando os dados da requisi√ß√£o atrav√©s da entrada padr√£o. A sa√≠da do processo era lida pelo servidor Web e devolvida em uma resposta HTTP.</p>

<p>Assim o PHP nasceu, sendo uma esp√©cie de <em>framework</em> C. O Apache executava um programa escrito em C, onde PHP era um conjunto de ferramentas para facilitar a escrita, principalmente de <em>templates</em> (para n√£o misturar C e HTML).</p>

<p>Esta √© a forma mais rudimentar de se executar um c√≥digo <em>server-side</em> e n√£o √© mais recomendada, pois h√° alternativas mais interessantes que veremos neste artigo.</p>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="apache-mod_php">Apache mod_php</h2>

<p>Conforme o PHP (e a Web em si) foi evoluindo, a abordagem utilizando CGI foi se mostrando ineficaz, desperdi√ßando recursos de processamento.</p>

<p>Neste momento surgiu um m√≥dulo do PHP para Apache, o famoso <code>mod_php</code>. Esse m√≥dulo "anexava" um execut√°vel do PHP em cada processo do Apache, ou seja, a cada processo que o Apache criava para servir uma requisi√ß√£o, o execut√°vel do PHP era tamb√©m inicializado, mesmo que a requisi√ß√£o fosse apenas para servir arquivos est√°ticos e o PHP n√£o fosse necess√°rio.</p>

<p>Isso era muito mais r√°pido do que utilizar CGI, mas ainda havia muito desperd√≠cio de recursos. O apache evoluiu a ponto de n√£o precisar criar um processo a cada nova requisi√ß√£o e passou a trabalhar com <em>threads</em>, mas al√©m dessa evolu√ß√£o ter demorado para acontecer, esse modelo n√£o funciona bem com o <code>mod_php</code>.</p>

<h2 id="fastcgi-e-php-fpm">FastCGI e PHP-FPM</h2>

<p>Com a nova solu√ß√£o do <code>mod_php</code> tamb√©m se mostrando ineficaz perante a tantas evolu√ß√µes do PHP e da Web (ambos sempre cresceram juntos), o protocolo FastCGI passou a ser utilizado. Com isso, um servidor Web recebia as requisi√ß√µes e apenas se fosse necess√°rio algum processamento, executaria o PHP.</p>

<p>Por√©m, essa execu√ß√£o n√£o era como no CGI. Um conceito de "processos persistentes" foi utilizado, diminuindo muito a quantidade de recursos necess√°rios para processar cada requisi√ß√£o. Um √∫nico processo agora passa a ser capaz de tratar diversas requisi√ß√µes e n√£o apenas uma. Com isso todo o <em>overhead</em> de criar e matar processos a cada requisi√ß√£o foi drasticamente reduzido.</p>

<p>Para extrair o m√°ximo do protocolo FastCGI, foi desenvolvida uma ferramenta chamada PHP-FPM (<em>FastCGI Process Manager</em>). Este servidor de aplica√ß√£o permite que realizemos diversas configura√ß√µes como o n√∫mero de processos <em>workers</em>, a quantidade de recursos liberada para cada processo e muito mais. Este √© o software utilizado atualmente para termos um servidor FastCGI em produ√ß√£o com PHP.</p>

<p>Atualmente, qualquer servidor web que saiba se comunicar atrav√©s do protocolo FastCGI pode ser utilizado em conjunto com PHP, mas o <em>Nginx</em> ganhou muita for√ßa por prometer (e segundo benchmarks, cumprir) entregar diversas melhorias de performance em rela√ß√£o ao Apache. Os recursos s√£o mais bem gerenciados e o uso de programa√ß√£o ass√≠ncrona atrav√©s de <em>multiplexing</em> de I/O trazem ganhos expressivos quando comparamos com o ainda amplamente utilizado Apache.</p>

<h2 id="arquitetura-_share-nothing_">Arquitetura <em>share-nothing</em></h2>

<p>Em qualquer uma das abordagens citadas at√© agora, uma das principais filosofias do PHP se mant√©m: a <em>share-nothing architecture</em>.</p>

<p>A ideia por tr√°s disso √© n√£o compartilhar nenhum recurso entre uma requisi√ß√£o e outra. Por mais que o mesmo processo possa ser utilizado para servir m√∫ltiplas requisi√ß√µes, em nosso c√≥digo, cada execu√ß√£o √© como um novo processo. Ao finalizar a execu√ß√£o de um c√≥digo PHP, todas as vari√°veis s√£o exclu√≠das, todos os recursos s√£o liberados. Praticamente nada √© armazenado entre uma requisi√ß√£o e outra.</p>

<p>Isso permitiu e ainda permite que o PHP tenha uma arquitetura muito simples de escalar e isso √© um dos fatores que contribu√≠ram para a ampla ado√ß√£o do PHP como linguagem back-end Web.</p>

<p>A abordagem utilizando Nginx + PHP-FPM √© a ideal para grande parte das aplica√ß√µes que usam PHP, por√©m existem cen√°rios onde ainda mais performance √© necess√°ria.</p>

<h2 id="servidores-auto-contidos">Servidores auto-contidos</h2>

<p>Quando temos milh√µes de requisi√ß√µes chegando ou comunica√ß√£o em tempo real acontecendo, o fato de ser necess√°ria a inicializa√ß√£o de todas as vari√°veis novamente e o in√≠cio do c√≥digo de toda nossa aplica√ß√£o ter que ser realizada a cada requisi√ß√£o pode ser um peso. Imagine que a cada requisi√ß√£o seu <em>framework</em> favorito (que provavelmente √© bem pesado) precisa ser inicializado novamente.</p>

<p>Para resolver os problemas deste tipo de aplica√ß√£o que demanda um n√≠vel a mais de performance, servidores auto-contidos podem ser utilizados. Um servidor auto-contido √© um serivdor web exposto pela pr√≥pria aplica√ß√£o, ou seja, seu pr√≥prio c√≥digo PHP recebe diretamente as requisi√ß√µes.</p>

<p>Com isso a inicializa√ß√£o da sua aplica√ß√£o pode ser feita uma √∫nica vez e a cada nova requisi√ß√£o, podemos somente executar o c√≥digo necess√°rio, sem necessidade de levantar de novo o <em>framework</em>, buscar as configura√ß√µes, ler vari√°veis de ambiente, processar as depend√™ncias, definir as rotas, etc.</p>

<p>Essa abordagem j√° √© poss√≠vel h√° muito tempo. Um dos precursores desta t√©cnica √© o <a href="https://github.com/php-pm/php-pm">PHP-PM</a> que usa o <a href="https://reactphp.org/">ReactPHP</a> por baixo dos panos. O ReactPHP facilita a execu√ß√£o de c√≥digo ass√≠ncrono e n√£o bloqueante no PHP atrav√©s de um <em>Event Loop</em>. N√≥s falamos um pouco sobre programa√ß√£o ass√≠ncrona <a href="/2020-09-16-php-assincrono-de-forma-nativa/">neste post</a>. O ReactPHP torna esta tarefa MUITO mais f√°cil, por isso ferramentas como PHP-PM puderam surgir.</p>

<p>Outros <em>frameworks</em> como <a href="https://amphp.org/">Amp PHP</a> t√™m a mesma proposta, por√©m uma ferramenta um pouco diferente tem chamado muita aten√ß√£o nos √∫ltimos anos e levado essa proposta para outro n√≠vel</p>

<h2 id="swoole">Swoole</h2>

<p>√â imposs√≠vel falar de servidores auto-contidos PHP e n√£o citar o <a href="https://www.swoole.co.uk/">Swoole</a>.</p>

<p>A principal diferen√ßa entre o Swoole e as demais ferramentas citadas de servidores auto-contidos √© que o Swoole n√£o √© um componente em PHP e sim uma extens√£o, ou seja, o Swoole foi escrito em C e compilado para ser "integrado" ao PHP. Isso al√©m de conceder ainda mais performance para o c√≥digo, ainda d√° poderes a mais para o Swoole como lidar de forma ass√≠ncrona com c√≥digo que originalmente seria s√≠ncrono (como com PDO e curl, por exemplo).</p>

<p>J√° existe material por a√≠ sobre Swoole, inclusive <a href="https://youtu.be/GCECSLtT49U">esse v√≠deo</a> no meu canal e o <a href="https://amzn.to/3gxamov">livro</a> escrito por um dos criadores da ferramenta, por isso n√£o vou transformar esse artigo em um tutorial, mas vale a pena pesquisar mais a fundo.</p>

<h2 id="conclus%C3%A3o">Conclus√£o</h2>

<p>Vimos neste artigo que h√° v√°rias formas para fazer com que uma requisi√ß√£o chegue no PHP. Algumas bem antigas, outras bem modernas.</p>

<p>Atualmente as 2 op√ß√µes aceit√°veis s√£o utilizando PHP-FPM ou algum servidor auto-contido. Nenhuma das 2 abordagens tira o papel de servidores Web como o amado Apache ou o moderno Nginx.</p>

<p>No caso do PHP-FPM precisamos de um servidor para receber as requisi√ß√µes HTTP e enviar as chamadas para o PHP com FastCGI. No caso de um servidor auto-contido, podemos ter um proxy reverso servindo os arquivos est√°ticos e realizando cache, por exemplo, enquanto o servidor auto-contido responde apenas as requisi√ß√µes realmente necess√°rias.</p>

<p>Se voc√™ quiser aprender mais sobre algum desses assuntos, pode considerar assinar a Alura. L√° existem treinamentos (gravados por mim) sobre Nginx, ReactPHP, Swoole e muito mais. Caso pretenda estudar na Alura, <a href="https://www.alura.com.br/promocao/diasdedev">neste link</a> voc√™ tem um desconto de 10%.</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Por que n√£o usar XAMPP]]></title>
            <link href="https://dias.dev/2021-04-10-por-que-nao-usar-xampp/"/>
            <updated>2021-04-10T00:00:00+00:00</updated>
            <id>https://dias.dev/2021-04-10-por-que-nao-usar-xampp/</id>
            <content type="html"><![CDATA[<p>Umas das perguntas mais frequentes que vejo em comunidades de iniciantes em PHP s√£o:
- Como instalar o XAMPP?
- Como configurar URLs amig√°veis no XAMPP?
- Por que o MySQL n√£o funciona com XAMPP?</p>

<p>A resposta que eu gostaria de dar geralmente √©: ‚Äúpare de usar XAMPP!‚Äù, mas sempre tento ajudar.</p>

<p>A ideia desse artigo √© expor a raz√£o para eu n√£o recomendar XAMPP e acreditar que essa ferramenta traz muito mais
problemas do que solu√ß√£o.</p>

<h2 id="o-que-%C3%A9-e-para-que-serve-xampp%3F">O que √© e para que serve XAMPP?</h2>

<p>Antes de falarmos os motivos de n√£o usar XAMPP, √© importante entendermos o que √© a ferramenta. XAMPP √© uma sigla para
<strong>A</strong>pache, <strong>M</strong>ySQL, <strong>P</strong>HP e <strong>P</strong>earl, sendo o <strong>X</strong> inicial para identificar que esta ferramenta √© multiplataforma
(funciona em Windows, Linux e Mac).</p>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="qual-o-problema-dessa-abordagem%3F">Qual o problema dessa abordagem?</h2>

<p>Existem alguns problemas com o uso dessa ferramenta, principalmente por iniciantes (que s√£o justamente o p√∫blico alvo da
ferramenta).</p>

<h3 id="processo-de-aprendizado">Processo de aprendizado</h3>

<p>Ao aprender Java, C#, C ou alguma outra linguagem considerada mais <em>enterprise</em>, √© comum aprendermos a sintaxe primeiro,
rodando simples c√≥digos na linha de comando. Depois estudamos um pouco sobre o paradigma principal usado na linguagem e
s√≥ ent√£o, se for o caso de uma linguagem Web, aprendemos a us√°-la na Web.</p>

<p>Por que um iniciante aprenderia a usar PHP na Web configurando um Apache e se conectando a um banco MySQL tudo de uma
vez s√≥?</p>

<p>Infelizmente muitos treinamentos que encontramos pela internet s√£o ministrados por pessoas que n√£o se atualizaram e nem
ao menos trabalham com as tecnologias que se prop√µem a ensinar.</p>

<h3 id="dificuldades-desnecess%C3%A1rias">Dificuldades desnecess√°rias</h3>

<p>Supondo que voc√™ j√° conhe√ßa a linguagem e queira apenas um ambiente simplificado para continuar seus estudos. Como ter
Apache, MySQL e Pearl instalados na sua m√°quina pode te ajudar? Problemas de configura√ß√£o no Apache, configura√ß√µes
espec√≠ficas para frameworks‚Ä¶ Essas complica√ß√µes infelizmente s√£o muito comuns e geradas pelo XAMPP quando talvez tudo que
precis√°vamos era do PHP instalado.</p>

<h2 id="o-que-aprender-primeiro%3F">O que aprender primeiro?</h2>

<p>Minha recomenda√ß√£o sempre √© para aprender primeiro a linguagem que se vai utilizar. Como estamos falando do XAMPP,
aprender PHP. Estude a sintaxe da linguagem, entenda como aplicar os conceitos de l√≥gica de programa√ß√£o usando a
linguagem. Estude sobre Orienta√ß√£o a Objetos, aprenda a organizar um c√≥digo de exemplo. S√≥ depois voc√™ vai pensar em
usar PHP no mundo da Web. E quando chegar o momento, voc√™ n√£o vai sair de cara configurando um servidor Web como o
Apache.</p>

<h2 id="como-usar-php-sem-xampp%3F">Como usar PHP sem XAMPP?</h2>

<p>No cap√≠tulo anterior citei que primeiro os iniciantes deveriam estudar a sintaxe da linguagem e executar alguns c√≥digos
na linha de comando, mas como rodar um c√≥digo PHP sem XAMPP?</p>

<p>Simples: Instalando o PHP no seu computador.</p>

<p>Existem diversas maneiras de se usar o PHP em cada sistema operacional, ent√£o vou citar aqui algumas formas, mas n√£o se
limite a elas.</p>

<h3 id="como-instalar-php-no-windows%3F">Como instalar PHP no Windows?</h3>

<p>Para usar o PHP no Windows, tudo que precisamos fazer √© baixar o execut√°vel na p√°gina oficial de downloads do PHP para
Windows: https://windows.php.net/download</p>

<p>Nesta p√°gina voc√™ ter√° acesso ao download de um zip, e neste zip voc√™ encontra o execut√°vel do PHP. Sendo assim, basta
extrair onde desejar que o PHP seja instalado e pronto. Desta forma, para executar o PHP, acesse no <em>Prompt de Comando</em>
a pasta em quest√£o (usando o comando <code>cd</code>) e a partir de l√° voc√™ poder√° executar o comando <code>php</code>.</p>

<p>Para executar o PHP a partir de qualquer pasta no prompt de comando, voc√™ pode adicionar o caminho de instala√ß√£o na
vari√°vel <em>PATH</em> do sistema. Existem diversos tutoriais explicando o que √© e como modificar a vari√°vel de sitema <em>PATH</em>,
mas se voc√™ quiser que eu fale disso, me conta nos coment√°rios.</p>

<h3 id="como-instalar-php-no-linux%3F">Como instalar PHP no Linux?</h3>

<p>A maioria das distribui√ß√µes Linux j√° v√™m com um pacote PHP pronto para ser instalado atrav√©s do gerenciador de pacotes.
Em distribui√ß√µes baseadas em <em>Debian</em>, por exemplo, basta executar <code>sudo apt install php</code> e voc√™ j√° ter√° o PHP instalado
em sua m√°quina.</p>

<p>Sempre h√° a op√ß√£o de compilar o PHP de forma personalizada e eu recomendo fazer isso quando voc√™ j√° tiver mais intimdade
com a linguagem. √â um bom aprendizado.</p>

<h3 id="como-instalar-php-no-mac%3F">Como instalar PHP no Mac?</h3>

<p>No momento da escrita deste artigo o PHP j√° vem instalado no Mac por padr√£o. :-D</p>

<p>Por√©m via de regra uma vers√£o mais antiga e com menos extens√µes v√™m instalada, ent√£o o ideal √© utilizar o Homebrew
para instalar o PHP e facilitar instala√ß√£o de extens√µes no futuro.</p>

<h2 id="e-como-aprender-web-sem-apache%3F">E como aprender Web sem Apache?</h2>

<p>Se voc√™ tem o PHP na sua m√°quina voc√™ j√° tem tamb√©m um servidor web instalado, sem precisar alterar arquivos de configura√ß√£o, abrir
portas, etc. O PHP vem com um <a href="https://www.php.net/manual/en/features.commandline.webserver.php">servidor embutido</a>
desde 2011 e ele serve exatamente para termos um ambiente web de desenvolvimento simplificado.</p>

<p>Al√©m de servir conte√∫dos processados pelo PHP, este servidor tamb√©m √© capaz de servir arquivos est√°ticos e realizar
roteamento simples para um ponto de entrada em sua aplica√ß√£o, por exemplo.</p>

<p>E claro, quando chegar o momento de sair do ambiente de desenvolvimento e aprender sobre realizar deploys, voc√™ vai
estudar sobre servidores Web. Muito provavelmente voc√™ vai se deparar com artigos sobre Nginx, PHP-FPM, etc. Mas isso √©
assunto para outro momento, e n√£o para o in√≠cio do aprendizado em PHP.</p>

<h2 id="como-fa%C3%A7o-para-sair-de-2011-no-php%3F">Como fa√ßo para sair de 2011 no PHP?</h2>

<p>Se voc√™ percebeu que est√° aprendendo PHP de forma desatualizada e supercomplicada sem necessidade, n√£o se preocupe nem
se sinta sozinho. Infelizmente a maioria de n√≥s passou por isso. O primeiro passo para resolver um problema √© entender
que h√° um problema.</p>

<p>Dado esse primeiro passo (inclusive, parab√©ns), vamos pesquisar materiais atualizados para aprendermos PHP como deve ser.</p>

<p>Um dos melhores livros que li como iniciante √© o <a href="https://amzn.to/3fTOPaF">Modern PHP</a>.
Se preferir em Portugu√™s, <a href="https://amzn.to/3dLk4lx">PHP Moderno</a>. Esse livro √© de antes do PHP 7 ser lan√ßado ent√£o ele
trata da evolu√ß√£o da linguagem sem entrar nos detalhes de sintaxes de 2016 pra c√°.</p>

<p>A partir da√≠, caso voc√™ tenha aprendido a usar o PHP 5, se atualize nas novidades da linguagem. No momento da escrita
deste post n√≥s estamos na <a href="https://www.youtube.com/playlist?list=PL3j2sfzg3FPuQXklYI2LumuG7jgZsj7cK">vers√£o 8</a>.</p>

<h2 id="conclus%C3%A3o">Conclus√£o</h2>

<p>XAMPP foi uma ferramenta que ajudou bastante gente que precisava de um ambiente de desenvolvimento web um pouco mais
simples antes de 2011, j√° que ele facilitava a instala√ß√£o da praticamente a √∫nica op√ß√£o do mercado: Apache.</p>

<p>Por√©m h√° 10 anos Apache n√£o √© mais necess√°rio para um ambiente simples de aprendizado e desenvolvimento, e se o assunto
for um servidor de produ√ß√£o, XAMPP nunca foi uma alternativa vi√°vel. Sendo assim, para desenvolvedores PHP, n√£o h√°
motivos v√°lidos para uso do XAMPP nos dias atuais.</p>

<p>Se voc√™ quiser aprender mais sobre algum desses assuntos, pode considerar assinar a Alura. L√° existem treinamentos (gravados por mim) sobre PHP, Nginx e muito mais. Caso pretenda estudar na Alura, <a href="https://www.alura.com.br/promocao/diasdedev">neste link</a> voc√™ tem um desconto de 10%.</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Requisi√ß√µes HTTP paralelas com PHP]]></title>
            <link href="https://dias.dev/2021-03-13-requisicoes-http-paralelas-com-php/"/>
            <updated>2021-03-13T00:00:00+00:00</updated>
            <id>https://dias.dev/2021-03-13-requisicoes-http-paralelas-com-php/</id>
            <content type="html"><![CDATA[<h2 id="i%2Fo-n%C3%A3o-bloqueante-programa%C3%A7%C3%A3o-ass%C3%ADncrona">I/O n√£o bloqueante (programa√ß√£o ass√≠ncrona)</h2>

<p>Em um <a href="/2020-09-16-php-assincrono-de-forma-nativa/">post anterior</a> falei bastante sobre como o PHP trabalha por baixo dos panos de forma nativa com I/O n√£o
bloqueante, e consequentemente com programa√ß√£o ass√≠ncrona. Usando os conhecimentos daquele post com conhecimentos de
<em>sockets</em> e HTTP seria poss√≠vel realizarmos chamadas HTTP ass√≠ncronas e process√°-las conforme elas fossem recebidas.
Por√©m √© bastante comum podermos nos dar ao luxo de processar todas as respostas HTTP depois de prontas, desde que todas
as requisi√ß√µes tenham sido feitas de forma concorrente.</p>

<h2 id="curl">cURL</h2>

<p>Como realizar requisi√ß√µes HTTP usando <em>sockets</em> pode se tornar uma tarefa muito complicada, principalmente em cen√°rios
onde precisamos enviar dados (requisi√ß√µes POST, por exemplo), cURL √© uma alternativa muito interessante. Essa biblioteca
√© pensada especialmente em realizar requisi√ß√µes pela rede e possui diversos facilitadores.</p>

<h2 id="o-problema">O problema</h2>

<p>Entendido o contexto das tecnologias que temos dispon√≠veis, vamos falar do problema que temos em m√£os. Existe uma API
que fornece informa√ß√µes sobre o universo <em>Star Wars</em>. Essa API √© gratuita e vai servir perfeitamente para nosso exemplo.</p>

<p>O que queremos fazer √© buscar a lista de filmes (atrav√©s da url https://swapi.dev/api/films/) e para cada filme buscar
os seus detalhes em outra URL (https://swapi.dev/api/films/:id/).</p>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h3 id="solu%C3%A7%C3%A3o-bloqueante">Solu√ß√£o bloqueante</h3>

<p>Usando o <code>cURL</code> de forma ‚Äúpadr√£o‚Äù, ou seja, bloqueante, podemos atingir este objetivo com o seguinte c√≥digo:</p>

<pre><code class="php">&lt;?php

$handle = curl_init('https://swapi.dev/api/films/');
// informa que n√£o queremos exibir a resposta diretamente, mas sim pegar seu retorno
curl_setopt($handle, CURLOPT_RETURNTRANSFER, true);
$response = curl_exec($handle);
curl_close($handle);

$data = json_decode($response, true);
$movies = $data['results'];

foreach ($movies as $movie) {
    // Alterando o protocolo para https
    $url = str_replace('http:', 'https:', $movie['url']);
    $handle = curl_init($url);
    curl_setopt($handle, CURLOPT_RETURNTRANSFER, true);
    $response = curl_exec($handle);

    $movieData = json_decode($response, true);
    var_dump($movieData);
}
</code></pre>

<p>O problema desta abordagem √© que cada requisi√ß√£o para os detalhes do filme vai travar a execu√ß√£o do PHP, fazendo
com que a pr√≥xima requisi√ß√£o s√≥ seja iniciada quando a anterior for finalizada.</p>

<h3 id="solu%C3%A7%C3%A3o-n%C3%A3o-bloqueante">Solu√ß√£o n√£o bloqueante</h3>

<p>Para informarmos um determinado n√∫mero de requisi√ß√µes e realizarmos todas de uma vez, podemos usar o <code>curl_multi_init</code>.</p>

<pre><code class="php">&lt;?php

// Primeira requisi√ß√£o como no c√≥digo anterior
$movies = $data['results'];

// Inicializa o handle de m√∫ltiplas conex√µes
$multiHandle = curl_multi_init();

// Armazena cada handle individual em um array
// al√©m de adicion√°-los ao $multiHandle
$handles = [];
foreach ($movies as $i =&gt; $movie) {
    $url = str_replace('http:', 'https:', $movie['url']);
    $handles[$i] = curl_init($url);
    curl_setopt($handles[$i], CURLOPT_RETURNTRANSFER, true);
    curl_multi_add_handle($multiHandle, $handles[$i]);
}
</code></pre>

<p>Assim n√≥s temos diversos <em>handles</em> do <code>cURL</code> adicionados a um gerenciador de m√∫ltiplas requisi√ß√µes. Quando executarmos o
<code>$multiHandle</code>, todas as requisi√ß√µes ser√£o feitas em paralelo. Maravilha, n√£o √© mesmo?</p>

<p>Infelizmente n√£o √© t√£o simples assim. N√£o basta fazer um <code>curl_multi_exec</code> e receber um array de respostas. A fun√ß√£o
<code>curl_multi_exec</code> inicia as requisi√ß√µes, por√©m n√£o bloqueia o c√≥digo, ou seja, n√≥s precisamos ficar em um <em>loop</em> verificando
se todas as requisi√ß√µes j√° foram feitas. Algo como:</p>

<pre><code class="php">do {
    $result = curl_multi_exec($multiHandle, $numberOfMissingHandles);
} while ($numberOfMissingHandles &gt; 0);

// Processar respostas
</code></pre>

<p>A vari√°vel <code>$numberOfMissingHandles</code> √© passada por refer√™ncia e √© preenchida com o n√∫mero dos <em>handles</em> que faltam ser
resolvidos. Em outras palavras, enquanto esse valor n√£o chegar a 0, temos requisi√ß√µes sendo processadas.</p>

<p>Depois de sair desse <em>loop</em>, podemos recuperar as respostas de todas as requisi√ß√µes, ent√£o voltamos para a tarefa f√°cil:</p>

<pre><code class="php">// Por isso armazenamos o array de $handles
foreach ($handles as $handle) {
    // Usamos curl_multi_getcontent para recuperar a resposta
    // de cada um dos handles que foi executado pelo curl_multi_exec
    $response = curl_multi_getcontent($handle);
    curl_multi_remove_handle($multiHandle, $handle);
    curl_close($handle);

    $movieData = json_decode($response, true);
    var_dump($movieData);
}
</code></pre>

<p>Com isso n√≥s atingimos o objetivo de realizar todas as requisi√ß√µes de uma vez e s√≥ depois ler as respostas.</p>

<h3 id="mal-uso-de-recursos">Mal uso de recursos</h3>

<p>O problema da nossa abordagem √© que a fun√ß√£o <code>curl_multi_exec</code> retorna imediatamente, sem esperar por nenhuma atividade
nos <em>handles</em>, ou seja, se as requisi√ß√µes forem demoradas ou houverem muitas requisi√ß√µes (ou ambos), esse <em>loop</em> vai ser
executado de forma muito r√°pida, por muito tempo. Isso vai fazer com que o uso de CPU v√° ao topo, atrasando inclusive o
processo de realizar requisi√ß√µes, afinal de contas o sistema operacional precisa destinar certos recursos para essa tarefa.</p>

<p>Para mitigar esse problema, podemos usar uma fun√ß√£o chamada <code>curl_multi_select</code>. Ela √© semelhante √† <code>stream_select</code> que
vimos no post sobre <a href="/2020-09-16-php-assincrono-de-forma-nativa/">PHP ass√≠ncrono</a>. Essa fun√ß√£o espera que alguma
atividade aconte√ßa nos handles que estamos utilizando. A diferen√ßa √© que ela n√£o recebe um array, mas sim o nosso
<code>$multiHandle</code>. Ent√£o tudo que temos de informa√ß√£o √© quantos <em>handles</em> possuem atividade no momento, mas n√£o quais deles.
Mas tudo bem, j√° que o nosso prop√≥sito √© ler todos apenas no final.</p>

<p>A fun√ß√£o <code>curl_multi_select</code> deve ser chamada ap√≥s o <code>curl_multi_exec</code>, j√° que √© essa que inicia as requisi√ß√µes efetivamente.
Ent√£o o nosso primeiro <em>loop</em> ficaria assim:</p>

<pre><code class="php">do {
    $result = curl_multi_exec($multiHandle, $numberOfMissingHandles);
    $descriptorsCount = curl_multi_select($multiHandle);
} while ($numberOfMissingHandles &gt; 0);
</code></pre>

<p>Onde <code>$descriptorsCount</code> √© o n√∫mero de handles que possuem alguma atividade nesse exato momento. Caso esse n√∫mero seja
<code>-1</code>, significa que aconteceu algum erro.</p>

<p>Dessa forma esse <em>loop</em> ser√° executado menos vezes e em um intervalo maior, ou seja, menos CPU ser√° consumida.</p>

<h3 id="tratamento-de-erros">Tratamento de erros</h3>

<p>Falando em erros, nosso c√≥digo est√° supondo que tudo vai correr bem. Nesse primeiro <em>loop</em> n√≥s precisamos realizar algumas
verifica√ß√µes. Ent√£o no final, teremos algo como:</p>

<pre><code class="php">do {
    $result = curl_multi_exec($multiHandle, $numberOfMissingHandles);
    if ($result !== CURLM_OK) { // CURLM_OK √© uma constante que indica sucesso nesse caso
        throw new RuntimeException('Error executing all the requests', $result);
    }

    $descriptorsCount = curl_multi_select($multiHandle);
    if ($descriptorsCount === -1) {
        throw new RuntimeException('Error checking for activity');
    }
} while ($numberOfMissingHandles);
</code></pre>

<h3 id="c%C3%B3digo-final">C√≥digo final</h3>

<p>Com isso finalizamos todo o processamento necess√°rio para realizar requisi√ß√µes paralelas com PHP. O c√≥digo completo vai
se parecer com isso:</p>

<pre><code class="php">&lt;?php

$handle = curl_init('https://swapi.dev/api/films/');
curl_setopt($handle, CURLOPT_RETURNTRANSFER, true);
$response = curl_exec($handle);
curl_close($handle);

$data = json_decode($response, true);
$movies = $data['results'];

$multiHandle = curl_multi_init();

$handles = [];
foreach ($movies as $i =&gt; $movie) {
    $url = str_replace('http:', 'https:', $movie['url']);
    $handles[$i] = curl_init($url);
    curl_setopt($handles[$i], CURLOPT_RETURNTRANSFER, true);
    curl_multi_add_handle($multiHandle, $handles[$i]);
}

do {
    $result = curl_multi_exec($multiHandle, $numberOfMissingHandles);
    if ($result !== CURLM_OK) {
        throw new RuntimeException('Error executing all the requests', $result);
    }

    $descriptorsCount = curl_multi_select($multiHandle);
    if ($descriptorsCount === -1) {
        throw new RuntimeException('Error checking for activity');
    }
} while ($numberOfMissingHandles &gt; 0);

foreach ($handles as $handle) {
    $response = curl_multi_getcontent($handle);
    curl_multi_remove_handle($multiHandle, $handle);
    curl_close($handle);

    $movieData = json_decode($response, true);
    var_dump($movieData);
}
</code></pre>

<p>Esse c√≥digo provavelmente pode ser refatorado para torn√°-lo um pouco mais leg√≠vel, mas acredito que a l√≥gica por tr√°s dele
tenha ficado clara. Caso contr√°rio, voc√™ pode usar a sess√£o de coment√°rios dessa p√°gina para fazer perguntas.</p>

<h2 id="benchmarks">Benchmarks</h2>

<p>Agora que temos 2 vers√µes de c√≥digo que resolvem o mesmo problema de formas diferentes, podemos testar a sua performance.
Para quem usa sistemas <em>Unix</em> (<em>Linux</em> ou <em>Mac</em>) existe um comando chamado <code>time</code> que √© muito √∫til para verifica√ß√µes simples
como essas.</p>

<p>A primeira vers√£o do nosso c√≥digo (bloqueante) gera essa informa√ß√£o quando executo o seguinte comando (sendo <code>star-wars.php</code>o nome do nosso arquivo):</p>

<pre><code class="bash">$ time php star-wars.php

php star-wars.php  0.14s user 0.04s system 2% cpu 7.186 total
</code></pre>

<p>Basicamente, um pouco mais de 7 segundos foram necess√°rios para executar todas as requisi√ß√µes.</p>

<p>J√° com a vers√£o final do c√≥digo, temos a seguinte sa√≠da:</p>

<pre><code class="bash">$ time php star-wars.php

php star-wars.php  0.14s user 0.04s system 6% cpu 2.387 total
</code></pre>

<p>Ou seja, pouco mais de 2 segundos (quase 5 segundos a menos). √â uma baita diferen√ßa para um exemplo t√£o simples, n√£o acha?</p>

<p>Agora um √∫ltimo teste, comentando a parte referente ao <code>curl_multi_select</code>:</p>

<pre><code class="bash">$ time php star-wars.php

php star-wars.php  0.50s user 0.70s system 49% cpu 2.421 total
</code></pre>

<p>Repare que o uso de CPU subiu muito. De algo pr√≥ximo de 6% para quase 50%. Esse √© o prop√≥sito da chamada da fun√ß√£o
<code>curl_multi_select</code>.</p>

<h2 id="conclus%C3%A3o">Conclus√£o</h2>

<p>Assim como j√° foi citado no post sobre <a href="/2020-09-16-php-assincrono-de-forma-nativa/">PHP ass√≠ncrono</a>, existem
v√°rias ferramentas que facilitam (e muito) o trabalho de realizar requisi√ß√µes HTTP paralelas com PHP. Guzzle √© uma √≥tima
op√ß√£o para isso.</p>

<p>Mas seguindo o que citei no <a href="/2020-04-23-principios-ou-ferramentas-o-que-estudar/">post sobre aprendizado</a>, eu penso como
Richard Feynman (Nobel de f√≠sica): ‚ÄúO que eu n√£o consigo criar, eu n√£o entendo‚Äù. Ent√£o antes de utilizar uma ferramenta
que realiza o trabalho para mim, eu gosto de saber como realizar este trabalho sem ela. Com isso, se algum problema
acontecer com a biblioteca, por exemplo, eu vou estar mais preparado para resolv√™-lo j√° que entendo um pouco melhor como as coisas funcionam.</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Wrapper de Streams php://]]></title>
            <link href="https://dias.dev/2020-11-03-wraper-de-streams-php/"/>
            <updated>2020-11-03T00:00:00+00:00</updated>
            <id>https://dias.dev/2020-11-03-wraper-de-streams-php/</id>
            <content type="html"><![CDATA[<h2 id="streams">Streams</h2>

<p>Antes de falarmos sobre um wrapper espec√≠fico, √© legal dar um certo contexto sobre streams.</p>

<p>Um stream basicamente √© um fluxo de dados. Usando streams podemos realizar opera√ß√µes de I/O como leitura de arquivos,
acessos a rede, comunica√ß√£o por sockets e muito mais.</p>

<p>Existem muitas funcionalidades que giram em torno dos streams do PHP como filtros, contextos, etc,
mas neste artigo meu foco vai ser em um wrapper espec√≠fico.</p>

<h2 id="wrappers">Wrappers</h2>

<p>Wrappers de streams em PHP s√£o o c√≥digo que diz como aquele determinado protocolo vai ser usado e gerenciado.</p>

<p>Ler um arquivo √© diferente de realizar uma requisi√ß√£o HTTP que √© diferente de se conectar com um Unix socket.
Para que todas essas diferen√ßas sejam abstra√≠das para n√≥s devs, o PHP fornece wrappers.</p>

<p>Quando voc√™ abre um arquivo para leitura em PHP, usa o wrapper <code>file://</code>.
Quando faz uma requisi√ß√£o HTTP, usa o wrapper <code>http://</code>.
Com wrappers diferentes, podemos utilizar o mesmo c√≥digo para realizar tarefas completamente diferentes. Ex.:</p>

<pre><code class="php">&lt;?php

echo file_get_contents('file://arquivo.txt'); // l√™ um arquivo
echo file_get_contents('http://google.com'); // faz uma requisi√ß√£o HTTP
</code></pre>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h3 id="wrappers-dispon%C3%ADveis">Wrappers dispon√≠veis</h3>

<p>Por padr√£o o PHP j√° fornece diversos wrappers como</p>

<ul>
<li><code>file://</code></li>
<li><code>http://</code> e <code>https://</code></li>
<li><code>ftp://</code></li>
<li><code>zlib://</code></li>
<li><code>ssh2://</code></li>
<li><code>rar://</code></li>
<li>etc</li>
</ul>

<p>Existem outros wrappers fornecidos por padr√£o e al√©m disso n√≥s podemos criar nossos pr√≥prios wrappers.
Mas isso foge do escopo desse artigo e no final dele vou deixar alguns links de refer√™ncias.</p>

<h2 id="wrapper-php%3A%2F%2F">Wrapper php://</h2>

<p>Um dos wrappers mais interessantes e que menos vejo material sobre √© o <code>php://</code>.
Atrav√©s dele temos acesso a diversos recursos de I/O como a entrada e sa√≠da padr√£o do sistema, streams tempor√°rios em
disco e em mem√≥ria, etc.</p>

<p>Vamos ver de forma resumida algumas das possibilidades deste wrapper</p>

<h3 id="php%3A%2F%2Finput">php://input</h3>

<p>Este provavelmente √© o stream mais utilizado fornecido por este wrapper. Atrav√©s dele n√≥s conseguimos acessar diretamente
o corpo de uma requisi√ß√£o. Ent√£o se uma requisi√ß√£o <code>POST</code> √© feita para seu sistema enviando o corpo em JSON, por exemplo,
o seguinte c√≥digo pode fazer o parse:</p>

<pre><code class="php">&lt;?php

$corpo = file_get_contents('php://input'); // recupera o corpo todo da requisi√ß√£o, como string
$json = json_decode($corpo); // decodifica a string em json

echo $json-&gt;algumValor; // acessa um valor j√° parseado
</code></pre>

<p>√â v√°lido citar que este stream permite apenas a leitura, logo, n√£o podemos escrever nada nele.</p>

<h3 id="php%3A%2F%2Fmemory-e-php%3A%2F%2Ftemp">php://memory e php://temp</h3>

<p>Ambos streams s√£o de leitura e escrita, e nos permitem acesso a um espa√ßo que pode ser no disco ou na RAM para manipular
dados tempor√°rios. S√£o interessantes para realizar processamentos em dados j√° existentes usando a interface de streams,
por exemplo.</p>

<p><code>php://memory</code> vai manter todo o dado na RAM enquanto <code>php://temp</code> vai utilizar um arquivo quando o conte√∫do do stream
atingir um limite de tamanho pr√©-definido (2MB por padr√£o).</p>

<h3 id="php%3A%2F%2Ffilter">php://filter</h3>

<p>Aplicar filtros de streams pode trazer grandes poderes para sua aplica√ß√£o e at√© poupar bastante uso de mem√≥ria.
Mas para utilizar filtros, teoricamente n√≥s precisar√≠amos de um recurso de stream aberto. Qual o problema disso?
N√£o poder√≠amos usar filtros com fun√ß√µes como <code>file_get_contents</code> que ao inv√©s de um recurso, recebe uma string por
par√¢metro.</p>

<p>Usando o stream <code>php://filter</code> n√≥s podemos especificar filtros para esse tipo de fun√ß√£o sem nenhum problema. Exemplo:</p>

<pre><code class="php">&lt;?php

echo file_get_contents("php://filter/read=string.toupper|string.rot13/resource=http://www.example.com");

</code></pre>

<p>Isso vai aplicar os filtros <code>string.toupper</code> e <code>string.rot13</code> ao ler de <em>http://www.example.com</em>.</p>

<p>Se voc√™ n√£o conhece os filtros de streams, vale a pena conferir as refer√™ncias no final do artigo. ;-)</p>

<h3 id="php%3A%2F%2Fstdin%2C-php%3A%2F%2Fstdout-e-php%3A%2F%2Fstderr">php://stdin, php://stdout e php://stderr</h3>

<p>Estes streams fornecem acesso aos streams correspondentes do pr√≥prio processo do PHP.
<code>php://stdin</code> fornece acesso √† entrada padr√£o do processo (que pode ser o teclado ou um pipe, por exemplo).
<code>php://stdout</code> permite acessar a sa√≠da padr√£o, que pode ser o terminal em uma aplica√ß√£o CLI.
<code>php://stderr</code> nos deixa escrever na sa√≠da de erro do processo.</p>

<p>O primeiro stream √© apenas para leitura, enquanto os 2 outros s√£o apenas para escrita. N√£o √© poss√≠vel escrever em
<code>php://stdin</code> por exemplo.</p>

<h3 id="php%3A%2F%2Foutput">php://output</h3>

<p>Este stream permite escrever no mecanismo de buffer de sa√≠da do PHP, assim como <code>echo</code> e <code>print</code> fazem.</p>

<h3 id="php%3A%2F%2Foutput-vs-php%3A%2F%2Fstdout">php://output vs php://stdout</h3>

<p>Voc√™ talvez esteja se perguntando a diferen√ßa entre <code>php://output</code> e <code>php://stdout</code>.
Basicamente o primeiro escreve no mecanismo de buffer de sa√≠da do PHP, o que permite o controle atrav√©s de fun√ß√µes
como <code>ob_start</code>. J√° o segundo escreve direto na sa√≠da do processo, n√£o passando pelo controle de buffer do PHP.</p>

<p>Para entender melhor:</p>

<pre><code class="php">&lt;?php

$stdout = fopen('php://stdout', 'w');
$output = fopen('php://output', 'w');

ob_start();

fwrite($output, 'Escrevendo no output' . PHP_EOL);
fwrite($stdout, 'Escrevendo na sa√≠da padr√£o' . PHP_EOL);

ob_end_flush();
</code></pre>

<p>Ao executar este script em um terminal, o primeiro <code>fwrite</code> envia a string para o mecanismo de buffer do PHP, e devido
ao <code>ob_start()</code>, n√£o vai ser imprimido ainda. O segundo <code>fwrite</code> manda o conte√∫do direto para a sa√≠da (tela do terminal).
Ao executar <code>ob_end_flush()</code> o buffer √© enviado para a sa√≠da do processo, ent√£o o resultado √©:</p>

<pre><code>Escrevendo na sa√≠da padr√£o
Escrevendo no output
</code></pre>

<h3 id="buffer-de-sa%C3%ADda">Buffer de sa√≠da</h3>

<p>Se voc√™ n√£o entendeu bem essa parte de buffer de sa√≠da e quiser que eu fa√ßa um artigo espec√≠fico sobre isso, √© s√≥ me
contar nos coment√°rios que eu preparo pra voc√™! :-D</p>

<h2 id="conclus%C3%A3o">Conclus√£o</h2>

<p>Analisando apenas um dos poss√≠veis wrappers d√° pra ter uma breve no√ß√£o de como essa feature do PHP √© poderosa. Atrav√©s
de streams podemos compactar e descompactar arquivos, enviar dados por FTP, acessar servidores via SSH e muito mais.</p>

<h3 id="refer%C3%AAncias">Refer√™ncias</h3>

<p>Conforme prometido, vou deixar aqui alguns links para que voc√™ possa se aprofundar nesse assunto t√£o rico e importante.</p>

<ul>
<li>https://www.youtube.com/watch?v=ZRYMzS97HVQ

<ul>
<li>Nessa palestra o <a href="https://twitter.com/alganet">Alexandre Gaigalas</a> mostra um pouco do poder dos streams</li>
</ul></li>
<li>https://www.php.net/manual/en/book.stream.php

<ul>
<li>A documenta√ß√£o oficial √© sempre um √≥timo lugar para recorrer e entender a fundo as funcionalidades</li>
</ul></li>
<li>https://cursos.alura.com.br/course/php-io-arquivos-streams

<ul>
<li>Na Alura existe um curso espec√≠fico de streams usando filtros, contextos e muito mais. Se quiser 10% de desconto na sua assinatura, confere <a href="https://www.alura.com.br/promocao/diasdedev">esse link aqui</a>.</li>
</ul></li>
<li><a href="/2020-09-16-php-assincrono-de-forma-nativa/">PHP Ass√≠ncrono de Forma Nativa</a>

<ul>
<li>Aqui mesmo no blog tem um post onde uso streams para realizar programa√ß√£o ass√≠ncrona atrav√©s de I/O n√£o bloqueante.</li>
</ul></li>
</ul>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[PHP al√©m da Web]]></title>
            <link href="https://dias.dev/2020-10-27-php-alem-da-web/"/>
            <updated>2020-10-27T00:00:00+00:00</updated>
            <id>https://dias.dev/2020-10-27-php-alem-da-web/</id>
            <content type="html"><![CDATA[<h2 id="php-%2B-web-%3D-">PHP + Web = &lt;3</h2>

<p>N√£o √© nenhum segredo que o PHP nasceu na web e para a web. Seu prop√≥sito inicial era servir p√°ginas din√¢micas de forma simples e amig√°vel, mas a Web evoluiu e o PHP tamb√©m. Hoje em dia o PHP √© uma linguagem de programa√ß√£o completa e pronta para ser executada nos mais diversos ambientes, e n√£o s√≥ na Web.</p>

<h3 id="web-al%C3%A9m-do-html">Web al√©m do HTML</h3>

<p>Antes de sair da Web, acredito que seja muito importante citar que nem s√≥ de HTML vive a Web. √â mais do que comum vermos URLs gerando dados nos mais diversos formatos como XML, JSON, etc. Voc√™ provavelmente conhece isso como API, correto? Obviamente o PHP est√° mais do que preparado para este tipo de trabalho e de forma muito simples. A ideia desse artigo √© trazer as possibilidades realmente fora da Web.</p>

<p><ins class="adsbygoogle"
style="display:block; text-align:center;"
data-ad-layout="in-article"
data-ad-format="fluid"
data-ad-client="ca-pub-8918461095244552"
data-ad-slot="2366637560"></ins></p>

<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="por-que-usar-php-fora-da-web%3F">Por que usar PHP fora da web?</h2>

<p>Antes de vermos as possibilidades, por que eu iria fazer isso? Se o PHP nasceu na Web, por que n√£o mant√™-lo l√°? Bom, existem diversos motivos para trazermos o PHP para demais ambientes, mas acredito que o mais √≥bvio e o principal √© a equipe. Se n√≥s j√° temos uma equipe de pessoas que desenvolvem em PHP na Web, por que n√£o utilizar esse conhecimento tamb√©m fora da Web para processamento de dados ass√≠ncronos, leitura de filas, cronjobs, scripts da CLI em geral, etc? √â justamente sobre essas possibilidades que quero tratar nesta publica√ß√£o.</p>

<h2 id="existe-vida-al%C3%A9m-da-web%3F">Existe vida al√©m da Web?</h2>

<p>Agora que j√° entendemos o motivo de possivelmente utilizar PHP fora da Web, vamos falar sobre... o que seria esse "fora da Web". Em uma equipe de desenvolvimento Web, o que poderia estar fora da Web para n√≥s precisarmos utilizar PHP?</p>

<h3 id="processos-ass%C3%ADncronos">Processos ass√≠ncronos</h3>

<p>Uma requisi√ß√£o web deve acontecer da forma mais r√°pida poss√≠vel para que o usu√°rio/cliente n√£o fique esperando uma resposta, e uma das t√©cnicas muito conhecidas para evitar essa espera √© tornar alguns processos ass√≠ncronos.</p>

<p>Se ao cadastrar um usu√°rio no banco de dados n√≥s precisamos enviar um e-mail, por exemplo, n√£o h√° necessidade de faz√™-lo esperar at√© n√≥s conseguirmos enviar este e-mail para s√≥ depois entregar a resposta. N√≥s podemos armazenar em algum lugar a informa√ß√£o de que um e-mail dever√° ser enviado, e fazer isso depois, fora da web, sem que o usu√°rio fique esperando.</p>

<p>Existem in√∫meras formas de atingir este objetivo. Uma das mais comuns √© atrav√©s de filas de processos. N√≥s armazenamos as informa√ß√µes sobre o processo que deve ser executado em algum local espec√≠fico para isso, e futuramente, fora da web, recuperamos esta informa√ß√£o para process√°-la. Banco de dados, mensagerias, onde for. O importante √© que a tarefa demorada n√£o fa√ßa com que o usu√°rio nos espere.</p>

<h3 id="scripts-cli">Scripts CLI</h3>

<p>Um cen√°rio tamb√©m muito comum, principalmente em empresas de m√©dio e grande porte, √© ter processos que devem ser executados periodicamente de forma manual ou automatica. Sincroniza√ß√£o de dados, processamento de informa√ß√µes, o que for... Essas tarefas n√£o precisam ser executadas em um ambiente web, e normalmente s√£o executadas na linha de comando. Os processos autom√°ticos s√£o conhecidos como <em>cronjobs</em> ou tarefas agendadas. J√° os processos executados manualmente s√£o simples scripts ou programas de linha de comando (CLI).</p>

<p>O PHP √© um execut√°vel capaz de rodar na linha de comando e n√£o h√° dificuldade nenhuma em utiliz√°-lo para estes casos. Inclusive h√° diversos recursos da linguagem que nos permitem acessar detalhes interessantes deste novo mundo fora da grande rede mundial.</p>

<h4 id="features-fora-da-web">Features fora da web</h4>

<p>Com PHP n√≥s conseguimos ler par√¢metros da linha de comando atrav√©s de vari√°veis "m√°gicas" como <a href="https://php.net/argv">$argv</a> e <a href="https://php.net/argc">$argc</a>. Isso nos permite interatividade de forma semelhante ao que a Web nos traria com formul√°rios, par√¢metros via URL, etc.</p>

<p>Al√©m de argumentos, podemos receber algumas op√ß√µes para personalizar a execu√ß√£o de nossos c√≥digos. A fun√ß√£o <a href="https://php.net/getopt">getopt</a> consegue nos ajudar a fazer isso de forma simples e profissional, exatamente como os mais famosos comandos que estamos habituados a utilizar j√° fazem.</p>

<h3 id="ferramentas">Ferramentas</h3>

<p>O mundo de componentes PHP √© fant√°stico. Temos ferramentas m√°gicas como Symfony para criar aplica√ß√µes Web, Doctrine para acessar o banco de dados com mais facilidade, PHPUnit para realizar testes automatizados... Mas ser√° que existem ferramentas espec√≠ficas para facilitar nosso mundo fora da Web? A resposta felizmente √© SIM!</p>

<h4 id="cria%C3%A7%C3%A3o-de-programas">Cria√ß√£o de programas</h4>

<p>O pr√≥prio Symfony possui uma das ferramentas mais conhecidas para cria√ß√£o de programas na CLI: O <a href="https://symfony.com/doc/current/components/console.html">Symfony Console</a>. Com ele n√≥s podemos criar aplica√ß√µes de forma semelhantes com a que criamos na Web, mas ao inv√©s de <em>Controllers</em> criamos <em>Commands</em>, por exemplo. Todas as facilidades de um framework moderno podem ser utilizadas fora da Web sem maiores problemas.</p>

<p>Obviamente est√° n√£o √© a √∫nica op√ß√£o, mas diversas outras ferramentas fazem uso do <em>Symfony Console</em>. Algumas alternativas s√£o <em>Laravel Zero</em>, CLImate, Aura.CLI, etc.</p>

<h4 id="performance">Performance</h4>

<p>Tarefas que s√£o executadas por tr√°s das cortinas tendem a ser mais pesadas, exigir mais I/O ou mais processamento. Nesses casos podemos recorrer a ferramentas espec√≠ficas para resolver tais problemas.</p>

<p>Se temos um cen√°rios de muitas requisi√ß√µes para servidores externos, seja em chamadas HTTP, STMP ou outros protocolos, devemos fazer bom uso dos streams do PHP e trabalhar com programa√ß√£o ass√≠ncrona. Uma √≥tima ferramenta que pode nos ajudar muito com isso √© a <a href="https://reactphp.org/#core-components">ReactPHP</a> que fornece diversos componentes com os mais diversos prop√≥sitos.</p>

<p>J√° se muito processamento √© utilizado, com calculos complexos, manipula√ß√£o de imagens e qualquer outra coisa que consuma muita CPU, paraleliza√ß√£o √© a resposta. Podemos criar processos atrav√©s da extens√£o <a href="https://php.net/pcntl">pcntl</a> ou threads atrav√©s da extens√£o <a href="https://php.net/parallel">parallel</a>. Ambas as op√ß√µes requerem um estudo mais aprofundado sobre conceitos de sistemas operacionais e programa√ß√£o paralela, mas o resultado √© muito gratificante.</p>

<p>Se voc√™ quiser entender um pouco melhor sobre a diferen√ßa entre Programa√ß√£o Ass√≠ncrona e Programa√ß√£o Paralela, pode conferir este v√≠deo: https://www.youtube.com/watch?v=zLfXPSeCkB8</p>

<h2 id="conclus%C3%A3o">Conclus√£o</h2>

<p>Nesta r√°pida leitura j√° conseguimos notar que n√£o s√≥ √© poss√≠vel utilizar PHP fora da Web como tamb√©m ele est√° muito preparado para este ambiente.</p>

<p>Por ser uma linguagem de programa√ß√£o completa e madura, diversas bibliotecas, extens√µes e componentes j√° surgiram para resolver problemas comuns e cabe a n√≥s, devs e amantes do PHP, aprend√™-las e utiliz√°-las.</p>

<p>Al√©m disso, com o advento do <a href="https://www.youtube.com/watch?v=WLx0z9kloro">JIT</a> que chegar√° no PHP 8, o uso do PHP fora da web se tornar√° ainda mais efetivo. Diversas otimiza√ß√µes de baixo n√≠vel que eu nem mesmo sei explicar v√£o acontecer, tornando poss√≠veis aplica√ß√µes que requerem ainda mais processamento como IoT, Machine Learning e v√°rios outros nomes bonitos que n√£o me arriscarei a citar.</p>

<p>Se voc√™ ainda acha que PHP est√° preso na Web, acredito que n√£o h√° momento melhor para abrir os olhos e conhecer este novo mundo!</p>
]]></content>
        </entry>
    </feed>